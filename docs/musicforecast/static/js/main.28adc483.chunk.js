(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{22:function(e,t,a){e.exports=a.p+"static/media/logo.5d762816.svg"},27:function(e,t,a){e.exports=a(88)},33:function(e,t,a){},34:function(e,t,a){},35:function(e,t,a){},36:function(e,t,a){},65:function(e,t,a){},88:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(12),s=a.n(i),c=(a(33),a(6)),l=a(7),o=a(9),u=a(8),h=a(5),d=a(10),m=a(22),f=a.n(m),v=(a(34),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleSearchBarChange=a.handleSearchBarChange.bind(Object(h.a)(a)),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"handleSearchBarChange",value:function(e){this.props.onSearchTextChange(e.target.value)}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("input",{type:"text",placeholder:"Search location...",value:this.props.searchText,onChange:this.handleSearchBarChange}))}}]),t}(n.Component)),p=(a(35),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).organiseResults=a.organiseResults.bind(Object(h.a)(a)),a.clickResult=a.clickResult.bind(Object(h.a)(a)),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"organiseResults",value:function(e){var t=this;return e.map(function(e,a){var n=e.city.state?e.city.displayName+", "+e.city.state.displayName+", "+e.city.country.displayName:e.city.displayName+", "+e.city.country.displayName;return r.a.createElement("li",{className:"result",key:a,onClick:function(a){return t.clickResult(e.metroArea.id,n,a)}},r.a.createElement("div",{className:"city"},e.city.displayName,", "),function(e){return e.city.state?r.a.createElement("div",{className:"state"},e.city.state.displayName,", "):null}(e),r.a.createElement("div",{className:"country"},e.city.country.displayName))})}},{key:"clickResult",value:function(e,t){this.props.locationSearch(e,t),this.props.onResultClick()}},{key:"render",value:function(){return r.a.createElement("ul",{id:"search-results"},this.organiseResults(this.props.apiResults))}}]),t}(n.Component)),g=(a(36),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={searchText:"",searchResults:null},a.handleSearchTextChange=a.handleSearchTextChange.bind(Object(h.a)(a)),a.handleSearchResultClick=a.handleSearchResultClick.bind(Object(h.a)(a)),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"handleSearchTextChange",value:function(e){var t=this;this.setState({searchText:e},function(){var e=t.state.searchText;""!==e&&fetch("https://music-forecast.herokuapp.com/locations/"+e).then(function(e){return 200!==e.status?void console.log("Looks like there was a problem with the SongKick location API. Status Code: "+e.status):e.json()}).then(function(e){e.resultsPage.totalEntries>0?t.setState({searchResults:e.resultsPage.results.location.slice(0,7)}):t.setState({searchResults:null})})})}},{key:"handleSearchResultClick",value:function(){this.setState({searchText:"",searchResults:null})}},{key:"render",value:function(){var e;return e=this.state.searchResults?r.a.createElement("div",{id:"searchResults"},r.a.createElement(p,{apiResults:this.state.searchResults,locationSearch:this.props.locationSearch,onResultClick:this.handleSearchResultClick})):null,r.a.createElement("div",{id:"seek"},r.a.createElement("div",{id:"searchbar"},r.a.createElement(v,{searchText:this.state.searchText,onSearchTextChange:this.handleSearchTextChange})),e)}}]),t}(n.Component)),y=a(23),b=function(e){function t(){return Object(c.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return this.props.active?r.a.createElement("div",null,r.a.createElement(y.ScaleLoader,{color:"rgb(50, 50, 50)"}),r.a.createElement("p",null,this.props.text)):null}}]),t}(n.Component),k=a(26),E=a(1),w=(a(65),a(14)),x=a(24),j=a.n(x),S=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).exitModal=a.exitModal.bind(Object(h.a)(a)),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"exitModal",value:function(){this.props.exitFunc()}},{key:"render",value:function(){var e=null!==this.props.selectedData?r.a.createElement("div",{className:"modal-container"},r.a.createElement("svg",{className:"close-btn",alt:"close",onClick:this.exitModal,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 802.5 802.5"},r.a.createElement("g",null,r.a.createElement("path",{d:"M401.25,246.25l235-235c15-15,39-15,55,0l100,101a39.24,39.24,0,0,1,0,55l-234,234,234,235c15,15,15,39,0,55l-100,100c-16,15-40,15-55,0l-235-234-234,234a39.24,39.24,0,0,1-55,0l-101-100c-15-16-15-40,0-55l235-235-235-234a39.24,39.24,0,0,1,0-55l101-101a39.24,39.24,0,0,1,55,0Z"}))),r.a.createElement("div",{className:"modal-header"},r.a.createElement("div",null,r.a.createElement("div",{className:"genre-name"},this.props.selectedData.name.toLowerCase()),r.a.createElement("div",{className:"city-name"}," ","in ",this.props.selectedData.location)),r.a.createElement("div",{className:"date-range"},this.props.selectedData.range.join(" to "))),r.a.createElement("div",{className:"event-cont"},this.props.selectedData.events.map(function(e){var t=e.artists.filter(function(e){return e.topGenres}).map(function(e){return e.topGenres.slice(0,5)}).flat().filter(function(e){return"seen live"!==e.name}).sort(function(e,t){return t.count-e.count}).slice(0,3).map(function(e){return e.name.toLowerCase()});return r.a.createElement("a",{href:e.link,key:e.link,rel:"noopener noreferrer",target:"_blank"},r.a.createElement("div",{className:"event-box"},r.a.createElement("div",{className:"event-header"},r.a.createElement("div",{className:"event-date"},e.date),r.a.createElement("div",{className:"event-genres"},t.join(", "))),r.a.createElement("div",{className:"event-name"},e.name.replace(/\(\w+ \d+, \d+\)/g,""))))}))):null;return r.a.createElement(j.a,{className:"modal-content",overlayClassName:"modal-overlay",isOpen:function(e,t){return!!(e&&t.events.length>0)}(this.props.active,this.props.selectedData),closeTimeoutMS:200,onRequestClose:this.exitModal,disableAutoFocus:!0,appElement:document.getElementById("root")},e)}}]),t}(r.a.Component),O=a(25),C=a.n(O),R=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={data:{},dimensions:{},rectCount:null,xScale:null,modal:!1,selection:null},a.xAxisRef=r.a.createRef(),a.brushRef=r.a.createRef(),a.renderAxes=a.renderAxes.bind(Object(h.a)(a)),a.renderBrushes=a.renderBrushes.bind(Object(h.a)(a)),a.clearModal=a.clearModal.bind(Object(h.a)(a)),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.renderAxes(),this.renderBrushes()}},{key:"componentDidUpdate",value:function(){this.renderAxes(),this.renderBrushes()}},{key:"renderAxes",value:function(){var e=E.a();e.ticks(window.innerWidth/100),e.scale(this.state.xScale),E.l(this.xAxisRef.current).call(e)}},{key:"renderBrushes",value:function(){var e=this;this.state.data.forEach(function(t,a){var n=[e.state.dimensions.margin.left,e.state.dimensions.margin.top+a*(e.state.dimensions.height/20)+18],r=[e.state.dimensions.width+e.state.dimensions.margin.left,e.state.dimensions.margin.top+(a+1)*(e.state.dimensions.height/20)+18],i=E.l(e.brushRef.current).append("g").attr("id",t.key+"-brush").attr("class","genre-brush"),s=E.b().extent([n,r]).on("end",function(){if(E.c.selection){var a=Object(k.a)(E.c.selection,2),n=a[0],r=a[1],c=[e.state.xScale.invert(n-e.state.dimensions.margin.left),e.state.xScale.invert(r-e.state.dimensions.margin.left)],l=[];t.values.forEach(function(e){if(0!==e.value.weight){var t=new Date(e.key);if(t>=c[0]&&t<=c[1])e.value.details.forEach(function(e){l.push(e)})}}),e.setState({modal:!0,selection:{name:t.key,location:e.props.location,events:l,range:c.map(function(e){return E.n("%B %d, %Y")(e)})}}),i.call(s.move,null)}});i.call(s)})}},{key:"clearModal",value:function(){this.setState({modal:!1})}},{key:"render",value:function(){var e=this.state.dimensions,t=this.state.rectCount;var a=this.state.data;return a?r.a.createElement("div",null,r.a.createElement("svg",{width:e.width+e.margin.left+e.margin.right,height:e.height+e.margin.top+e.margin.bottom},r.a.createElement(w.Trail,{items:function(a){return a.map(function(a,n){return r.a.createElement("g",{key:a.key,className:"genre-group",transform:"translate(".concat(0,", ",(n+1)*(e.height/20),")")},r.a.createElement("text",{x:e.margin.left-10,y:"3",className:"genre-label"},a.key.toLowerCase()),r.a.createElement("g",{transform:"translate(".concat(e.margin.left,", 0)")},function(e,t){return E.h(t).map(function(t,a){var n=e.xScale(t),r=e.xScale.bandwidth(),i=e.yScale(n),s=2*i,c=e.key+"-"+a,l=C.a.scale("GnBu"),o=l(e.colorScale(n)).hex();return{x:n,width:r,y:i,height:s,id:c,color:o}})}(a,t).map(function(e){var t=e.y<=0;return r.a.createElement("g",{key:e.id,className:t?"empty-bar":"data-bar"},r.a.createElement("rect",{x:e.x,y:t?-.1:-e.y,width:e.width,height:t?.2:e.height,fill:e.color}))})))})}(a),keys:function(e){return e.key+"barz"},from:{opacity:0,transform:"translate3d(0,-40px,0)"},to:{opacity:1,transform:"translate3d(0,0px,0)"}},function(e){return function(t){return r.a.createElement(w.animated.g,{style:t},e)}}),r.a.createElement("g",{ref:this.xAxisRef,transform:"translate(".concat(e.margin.left,", ").concat(this.state.dimensions.margin.top,")")}),r.a.createElement("g",{ref:this.brushRef})),r.a.createElement(S,{active:this.state.modal,exitFunc:this.clearModal,selectedData:this.state.selection})):null}}],[{key:"getDerivedStateFromProps",value:function(e){var t=e.dataSet;if(!t)return{};var a={top:30,right:window.innerWidth/8,bottom:30,left:window.innerWidth/8>120?window.innerWidth/8:120},n=window.innerWidth-window.innerWidth/20-a.left-a.right,r=2e3-a.top-a.bottom,i=E.o("%Y-%m-%d"),s=E.g().key(function(e){return e.genre}).key(function(e){return i(e.date)}).rollup(function(e){return{weight:E.m(e,function(e){return e.weight}),details:e.map(function(e){return e.details}).filter(function(e,t,a){return a.findIndex(function(t){return t.place===e.place&&t.name===e.name})===t})}}).entries(t).sort(function(e,t){return E.m(t.values,function(e){return e.value.weight})-E.m(e.values,function(e){return e.value.weight})}),c=E.d(t,function(e){return i(e.date)});var l=function(e,t){var a=[];return e.forEach(function(e){for(var n={key:e.key,values:[]},r=function(t){var a=!1,r=void 0;e.values.forEach(function(e){var n,i,s=new Date(e.key);i=s,(n=t).getFullYear()===i.getFullYear()&&n.getMonth()===i.getMonth()&&n.getDate()===i.getDate()&&(a=!0,r=e)}),a?n.values.push(r):n.values.push({key:new Date(t),value:{weight:0}})},i=new Date(t[0]);i<t[1];i.setDate(i.getDate()+1))r(i);a.push(n)}),a}(s,c),o=E.k().domain(c).range([0,n]),u=E.j().domain([E.f(l,function(e){return E.f(e.values,function(e){return e.value.weight})}),E.e(l,function(e){return E.e(e.values,function(e){return e.value.weight})})]).range([0,1]),h=Math.floor(window.innerWidth/4);return l.forEach(function(e){var t=[E.f(e.values,function(e){return e.value.weight}),E.e(e.values,function(e){return e.value.weight})],a=E.j().domain(t).range([0,r/40-5]);e.colorScale=E.j().domain(e.values.map(function(e){return o(new Date(e.key))})).range(e.values.map(function(e){return u(e.value.weight)})),e.yScale=E.j().domain(e.values.map(function(e){return o(new Date(e.key))})).range(e.values.map(function(e){return a(e.value.weight)})),e.xScale=E.i().domain(E.h(h)).paddingInner(.05).range([0,n])}),{data:l,dimensions:{margin:a,width:n,height:r},rectCount:h,xScale:o,globalYScale:u}}}]),t}(r.a.Component),N=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={location:null,loading:!0,ready:!1,stats:null},a.locationSearch=a.locationSearch.bind(Object(h.a)(a)),a.homeReset=a.homeReset.bind(Object(h.a)(a)),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;console.log("sent");fetch("https://music-forecast.herokuapp.com/status/").then(function(t){200===t.status&&e.setState({loading:!1,ready:!0})})}},{key:"locationSearch",value:function(e,t){var a=this;this.setState({location:t,loading:!0,stats:null}),fetch("https://music-forecast.herokuapp.com/events/"+e).then(function(e){return e.json()}).then(function(e){a.setState({loading:!1,stats:e})})}},{key:"homeReset",value:function(){this.setState({location:null,loading:!1,stats:null})}},{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement("img",{src:f.a,className:"App-logo",alt:"logo",onClick:this.homeReset})),this.state.ready?r.a.createElement("div",null,r.a.createElement(g,{locationSearch:this.locationSearch}),r.a.createElement("div",{className:"locationName"},this.state.location),r.a.createElement(b,{active:this.state.loading,text:"retrieving results"}),this.state.stats?r.a.createElement("div",{className:"data-visuals"},r.a.createElement(R,{dataSet:this.state.stats,location:this.state.location})):r.a.createElement("p",null,"(07-04-19) note: The entire world is not in the midst of some dreamy latvian trippy sludge metal takeover, the last.fm API is currently somewhat broken...")):r.a.createElement(b,{active:this.state.loading,text:"contacting server"}))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(N,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[27,1,2]]]);
//# sourceMappingURL=main.28adc483.chunk.js.map